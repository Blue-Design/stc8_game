C51 COMPILER V9.60.0.0   MAIN                                                              01/08/2021 19:05:38 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Out_File\main.obj
COMPILER INVOKED BY: D:\Keil_v5\C51\BIN\C51.EXE ..\User\main.c LARGE OPTIMIZE(8,SPEED) BROWSE INCDIR(..\Device;..\Librar
                    -ies;..\User) DEBUG OBJECTEXTEND PRINT(.\main.lst) OBJECT(.\Out_File\main.obj)

line level    source

   1          #include "main.h"
   2          #include "game_2048.h"
   3          
   4          uint8 B_100us = 0;
   5          uint16 tim0_ms = 50;
   6          uint8 sign_ir = 0;
   7          
   8          void main(void){
   9   1          pcf8563_Time localtime;
  10   1          
  11   1          // 时钟初始化
  12   1              InitMCU();
  13   1          Timer0_init();
  14   1          Timer4_init();
  15   1          EA = 1;             // 中断总开关
  16   1          
  17   1          // 硬件初始化
  18   1          pcf8563_init();
  19   1          ir_rx_init();
  20   1          tft_lcd_init();
  21   1          
  22   1          // 用RTC时间初始化随机数种子
  23   1          pcf8563_read_rtc(&localtime);
  24   1          srand(((long *)&localtime)[0]+((long *)&localtime)[1]);
  25   1          
  26   1          // 游戏初始化
  27   1          game2048_init();
  28   1          
  29   1          while(1){
  30   2              // 矩阵键盘输入
  31   2              if(IO_KeyState){
  32   3                  // 红外发送
  33   3                  //ir_send_nec(1, KEY_MAP[KeyCode]);
  34   3                  while(IO_KeyState);
  35   3              }
  36   2              // 红外输入
  37   2              if(B_100us){
  38   3                  B_100us = 0;
  39   3                  if(ir_rx_available()){
  40   4                      // 红外接收
  41   4                      sign_ir = ir_rx_ircode();
  42   4                  }
  43   3              }
  44   2              // 运行2048
  45   2              game2048_run();
  46   2              if(sign_ir){
  47   3                  game2048_updateStatus(sign_ir);
  48   3                  sign_ir = 0;
  49   3              }
  50   2          }
  51   1      }
  52          
  53          // 1ms
  54          void Timer0_interrupt(void) interrupt 1{
C51 COMPILER V9.60.0.0   MAIN                                                              01/08/2021 19:05:38 PAGE 2   

  55   1          static int cnt = 0;
  56   1          cnt = (cnt + 1) % tim0_ms;
  57   1          if(cnt == tim0_ms - 1){
  58   2              IO_KeyScan();
  59   2          }
  60   1      }
  61          
  62          // 0.1ms
  63          void Timer4_interrupt(void) interrupt 20{
  64   1          ir_rec_callback();      //红外接收回调函数
  65   1          B_100us = 1;
  66   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    295    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =    518       8
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
