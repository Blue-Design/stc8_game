C51 COMPILER V9.60.0.0   NIXIETUBE                                                         01/08/2021 01:23:25 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE NIXIETUBE
OBJECT MODULE PLACED IN .\Out_File\nixietube.obj
COMPILER INVOKED BY: D:\Keil_v5\C51\BIN\C51.EXE ..\Device\nixietube.c LARGE OPTIMIZE(8,SPEED) BROWSE INCDIR(..\Device;..
                    -\Libraries) DEBUG OBJECTEXTEND PRINT(.\nixietube.lst) OBJECT(.\Out_File\nixietube.obj)

line level    source

   1          #include "hc595.h"
   2          #include "nixietube.h"
   3          #include "delay.h"
   4          #include "math.h"
   5          
   6          //段码
   7          //0,1,2,3,4,5,6,7,8,9,A,B,C,D,E,F,-,NONE
   8          uint8 nix_seg[18]={0xC0,0xF9,0xA4,0xB0,0x99,0x92,0x82,0xF8,0x80,0x90,0x88,0x83,0xC6,0xA1,0x86,0x8E,0xBF,0x
             -FF};
   9          
  10          //========================================================================
  11          // 描述: 数码管显示初始化.
  12          // 参数: none.
  13          // 返回: none.
  14          //========================================================================
  15          void nix_init(){
  16   1          hc595_enable_nix();
  17   1          NIXIETUBE_PORT_MODE();//推挽输出
  18   1          NIXIETUBE_PORT=0xff;
  19   1      
  20   1          //左侧数码管冒号
  21   1          LEFT_COLON_PIN_MODE();//推挽输出
  22   1          LEFT_COLON_PIN = 1;
  23   1      
  24   1          //右侧数码管冒号
  25   1          RIGHT_COLON_PIN_MODE();//推挽输出
  26   1          RIGHT_COLON_PIN = 1;
  27   1      }
  28          
  29          void nix_display_num(int32 num){
  30   1          int8 n = 6;
  31   1          uint8 buf[8];
  32   1          if(num>=0){
  33   2              buf[7] = 17;
  34   2          }else{
  35   2              buf[7] = 16;
  36   2              num = -num; 
  37   2          }
  38   1          buf[0] = num%10;
  39   1          buf[1] = num/10%10;
  40   1          buf[2] = num/100%10;
  41   1          buf[3] = num/1000%10;
  42   1          buf[4] = num/10000%10;
  43   1          buf[5] = num/100000%10;
  44   1          buf[6] = num/1000000%10;
  45   1          while(buf[n] == 0)
  46   1              buf[n--] = 17;
  47   1          if(num==0) buf[0] = 0;
  48   1          for(n=7; n>=0; n--){
  49   2              hc595_bit_select(n);
  50   2              NIXIETUBE_PORT = nix_seg[buf[n]];
  51   2              delay(2);
  52   2              hc595_bit_disable();
  53   2          }
C51 COMPILER V9.60.0.0   NIXIETUBE                                                         01/08/2021 01:23:25 PAGE 2   

  54   1      }
  55          
  56          void nix_display_buf(uint8 begin, nix_content *buf, uint8 n){
  57   1          int8 i;
  58   1          if(begin<8 && n<=(8-begin)){
  59   2              i = 8 - begin - n;
  60   2              while(n--){
  61   3                  hc595_bit_select(i);
  62   3                  NIXIETUBE_PORT = nix_seg[buf[n]];
  63   3                  delay(2);
  64   3                  hc595_bit_disable();
  65   3                  i++;
  66   3              }   
  67   2          }
  68   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    596    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =     18      19
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
